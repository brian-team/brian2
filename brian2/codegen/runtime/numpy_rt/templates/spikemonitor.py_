# { USE_SPECIFIERS _i, _t, _spikes, _count, _num_source_neurons, t }

_n_spikes = len(_spikes)
if _n_spikes > 0:
    import numpy as np

    _curlen = len(_t)
    _newlen = _curlen + _n_spikes
    _t.resize(_newlen)
    _i.resize(_newlen)
    _t[_curlen:_newlen] = t
    _i[_curlen:_newlen] = _spikes

    # This is slow but correctly handles multiple spikes per neuron
    _count += np.bincount(_spikes, minlength=_num_source_neurons);